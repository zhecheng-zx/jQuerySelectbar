!function(e){"use strict";e.selectbar=function(t,n){if(!(this instanceof e.selectbar))return new e.selectbar(t,option);var a=this;return a.$container=e(t),a.$container.data("selectbar",a),a.init=function(){a.options=e.extend({},e.selectbar.defaultOptions,n),a.elem=t,a.selectbarId="#"+a.elem.attr("id"),a.className="selectbar",a.initSelectDatabaseDom(),a.initDatabase(),a.initSelectSelected(),a.addEvent()},a.initDatabase=function(){a.select_item(-1)},a.select_item=function(e){var t="";a.options.database.department.forEach(function(n,s){if(n.parentId==e){var i=a.selectItemDom(n,!0);t+=i}}),a.options.database.employees.forEach(function(n,s){if(n.parentId==e){var i=a.selectItemDom(n,!1);t+=i}}),a.elem.parent().find(".tree-list .tree-content .list").empty().append(t)},a.initSelectSelected=function(){var e="";a.options.database.employees&&a.options.database.employees.length>0&&a.options.database.employees.forEach(function(t,n){var s=a.selectOptionDom(t);e+=s}),a.elem.parent().find("select.form-control").empty().append(e),a.elem.parent().find(".selector-input-list-wrap .selected-list").empty(),a.options.values.forEach(function(e,t){a.options.database.employees.forEach(function(t,n){e==t.id&&a.addSelected(e,t.name)})})},a.addEvent=function(){var t=a.elem.parent();t.on("click",function(n){t.find(".vue-selector-input-wrap").show().css({top:t.height()}),e(document).one("click",function(){e(this).parents(a.selectbarId).length<=0&&t.find(".vue-selector-input-wrap").hide()}),n.stopPropagation()}),t.on("click",".select-item",function(){var n=e(this),s=n.find(".item-name").text(),i=n.find(".item-status input"),l=i.val();if(n.find(".item-status").hasClass("departments"))a.select_item(l),a.add_breadcrumb(l,s);else{var c=t.find(".selector-input-list-wrap .selected-list .selected-item"),r=!0;c.each(function(t,n){if(e(this).find(".item-name").attr("_id")==l)return a.removeSelected(l),void(r=!1)}),r&&a.addSelected(l,s)}}),t.on("click",".tree-list .tree-nav .old-node",function(){var t="";t="全部"==e(this).find(".nav-name").text().trim()?-1:e(this).find(".nav-name").attr("name"),e(this).removeClass("old-node").nextAll().remove(),a.select_item(t)}),t.on("click",".selected-list>li .remove-item",function(){var t=e(this).prev().attr("_id");a.removeSelected(t)}),t.on("keyup",".selector-search .search-input",function(){var t=e(this).val();if(""!=t&&null!=t&&void 0!=t){var n="";a.options.database.department.filter(function(e){return e.name.indexOf(t)>=0}).forEach(function(e,t){var s=a.selectItemDom(e,!0);n+=s});a.options.database.employees.filter(function(e){return e.name.indexOf(t)>=0}).forEach(function(e,t){var s=a.selectItemDom(e,!1);n+=s}),""==n&&(n+="<p>没有找到数据！</p>"),e(this).next(".search-clear").show().one("click",function(){e(this).hide().prev("input").val(""),a.select_item(-1)}),a.elem.parent().find(".tree-list .tree-nav>li").eq(0).nextAll().remove(),a.elem.parent().find(".tree-list .tree-content .list").empty().append(n)}else a.select_item(-1)})},a.add_breadcrumb=function(e,t){var n=a.elem.parent(),s="";s+='<li class="nav-node"><div class="nav-name" name="'+e+'"> '+t+" </div>",s+='<div class="nav-right nav-last">',s+='<svg version="1.1" role="presentation" width="8" height="16" viewBox="0 0 8 16" class="octicon">',s+='<path d="M7.5 8l-5 5L1 11.5 4.75 8 1 4.5 2.5 3z"></path>',s+="</svg>",s+="</div></li>",n.find(".tree-list .tree-nav .nav-node").addClass("old-node"),n.find(".tree-list .tree-nav").append(s)},a.addSelected=function(t,n){var t=t,s=a.elem.parent(),i="";i+='<li><div class="selected-item">',i+='<span class="item-name" _id="'+t+'">'+n+"</span>",i+='<span class="iconfont icon-cha remove-item"></span>',i+="</div></li>";var l=s.find(".selected-num .selected--num"),c=parseInt(l.text()),r=!1;r=a.options.values.some(function(e){return e===t}),a.options.multiple?(s.find(".selector-input-list-wrap .selected-list").append(i),a.elem.find("option[value="+t+"]").attr("selected","selected"),c++,r||a.options.values.push(t)):(s.find(".selector-input-list-wrap .selected-list").empty().append(i),a.elem.find("option").removeAttr("selected"),a.elem.find("option[value="+t+"]").attr("selected","selected"),c=1,a.options.values=[],a.options.values.push(t)),s.find(".item-status input[value="+t+"]").prop("checked",!0),s.find(".selector-input-list-wrap").find(".search-clear").show().one("click",function(){e(this).hide(),s.find(".selector-input-list-wrap .selected-list .selected-item").each(function(t,n){var s=e(this).find(".item-name").attr("_id");a.removeSelected(s)})}),l.text(c)},a.removeSelected=function(e){var t=a.elem.parent();t.find(".item-status input[value="+e+"]").prop("checked",!1),t.find(".selector-input-list-wrap .selected-list .selected-item .item-name[_id="+e+"]").parents("li").remove(),a.elem.find("option[value="+e+"]").removeAttr("selected"),a.options.values=a.options.values.filter(function(t){return t!=e});var n=t.find(".selected-num .selected--num"),s=parseInt(n.text());s--,n.text(s)},a.selectOptionDom=function(e){var t=e;return a.options.values.some(function(e){return e==t.id})?'<option value="'+t.id+'" selected="selected">'+t.name+"</option>":'<option value="'+t.id+'">'+t.name+"</option>"},a.selectItemDom=function(e,t){var n="",s="",i=a.options.values.some(function(t){return t==e.id});return t?(s='<div class="item-status departments"><div class="status-box"><input class="status" type="checkbox" value="'+e.id+'"></div></div>',n='<div class="item-group"><svg xmlns="http://www.w3.org/2000/svg" width="6" height="10" viewBox="0 0 6 10"><path fill="none" fill-rule="evenodd" stroke="#C3CBD9" stroke-linecap="round" stroke-linejoin="round" d="M1.322 9.16l4-4.16-4-4.16"></path></svg></div>'):(n="",s=a.options.multiple?i?'<div class="item-status"><div class="status-box"><input class="status" name="'+a.selectbarId+'" checked="checked" type="checkbox" value="'+e.id+'"></div></div>':'<div class="item-status"><div class="status-box"><input class="status" name="'+a.selectbarId+'" type="checkbox" value="'+e.id+'"></div></div>':i?'<div class="item-status"><div class="status-box"><input class="status" name="'+a.selectbarId+'" checked="checked" type="radio" value="'+e.id+'"></div></div>':'<div class="item-status"><div class="status-box"><input class="status" name="'+a.selectbarId+'" type="radio" value="'+e.id+'"></div></div>'),'<li class="select-item">'+s+'<div class="item-ell"><span title="'+e.id+'" class="item-name">'+e.name+"</span>"+n+"</div></li>"},a.searchClear=function(){var e=document.createElement("span");return e.className="search-clear",e.innerHTML='<i class="iconfont icon-cha"></i>',e},a.initSelectDatabaseDom=function(){var t=document.createElement("div"),n=(new Date).getTime();a.elem.hide().wrap(t).parent().addClass(a.className+" "+n),a.options.multiple&&a.elem.attr("multiple","multiple");var s=a.elem.parent(),i=e(document.createElement("div")),l=e(document.createElement("div")),c=e(document.createElement("ul")),r='<i class="iconfont icon-plus"></i><span class="trigger-text">'+a.options.title+"</span>";l.addClass("btn-trigger").append(r),c.addClass("selected-list"),i.addClass("selector-input-list-wrap").addClass(a.elem.attr("class")).append([c,l,a.searchClear()]),s.append([i,a.initSelectPanelWrapDom()]),s.find(".selector-search").append(a.searchClear())},a.initSelectPanelWrapDom=function(){var e=document.createElement("div");return e.className="vue-selector-input-wrap",e.appendChild(a.initSelectPanelDom()),e.appendChild(a.initSelectedCountDom()),e},a.initSelectPanelDom=function(){var e=document.createElement("div");e.className="selector-panel";return e.innerHTML='<div class="selector-search"><span class="search-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g fill="none" fill-rule="evenodd"><path data-v-501925db="" d="M0 0h16v16H0z"></path> <g transform="translate(1 1)"><circle cx="6" cy="6" r="5" stroke="#C3CBD9" stroke-width="2"></circle> <path fill="#C3CBD9" d="M9 10.414L10.414 9l2.952 2.952a.996.996 0 0 1-.002 1.412.995.995 0 0 1-1.412.002L9 10.414z"></path></g></g></svg></span><input placeholder="搜索" class="search-input" /></div><div class="switch-list-wrapper"><div class="switch-content"><div class="tree-list"><div class="tree-nav-wrap"><ul class="tree-nav"><li class="nav-node"><div class="nav-name"> 全部 </div><div class="nav-right"><svg version="1.1" role="presentation" width="8" height="16" viewBox="0 0 8 16" class="octicon"><path d="M7.5 8l-5 5L1 11.5 4.75 8 1 4.5 2.5 3z"></path></svg></div></li></ul></div><div class="tree-content"><div class="scroll-list"><ul class="list"></ul></div></div></div></div></div>',e},a.initSelectedCountDom=function(e){var t=document.createElement("div");return t.className="selected-num",t.innerHTML='<span class="selected--text">已选</span><span class="selected--num">'+(e||0)+"</span>",t},a.getSelectVal=function(){var t=[];return e(a.elem).find("option[selected=selected]").each(function(n,a){t.push(e(this).val())}),t},a.getSelectName=function(){var t=[];return e(a.elem).find("option[selected=selected]").each(function(n,a){t.push(e(this).text())}),t},a.setSelectVal=function(e){var t=[];return e instanceof Array?t=e:t.push(e),a.options.values=t,a.elem.parent().find(".selected-num .selected--num").text(0),a.initSelectSelected(),a},a.callMethod=function(e,t){switch(e){case"getSelectVal":return a.getSelectVal();case"getSelectName":return a.getSelectName();case"setSelectVal":return a.setSelectVal(t);case"destroy":a.$container.empty(),a.$container.removeData("selectbar");break;default:throw new Error('[selectbar] method "'+e+'" does not exist')}return a.$container},a.init(),a},e.selectbar.defaultOptions={title:"请选择……",database:{department:[],employees:[]},values:[]},e.fn.selectbar=function(){var t=this,n=Array.prototype.slice.call(arguments);if(void 0===typeof n||0==n.length){var a=e(t).data("selectbar");if(a)return a;throw new Error("[selectbar] the element is not instantiated")}if("string"==typeof n[0]){var a=e(t).data("selectbar");if(a)return a.callMethod(n[0],n[1]);throw new Error("[selectbar] the element is not instantiated")}return new e.selectbar(this,n[0])}}(jQuery);